<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>DrawingBoard API</title>
<link rel="stylesheet" href="http://iiiui.qiniudn.com/base.css" />
</head>
<body><div class="container"><blockquote>
  <p><strong>host: <a href="http://db.pamakids.com">http://db.pamakids.com</a></strong></p>
</blockquote>

<p><div class="toc"><div class="toc">
<ul>
<li><a href="#说明">说明</a></li>
<li><a href="#api">API</a><ul>
<li><a href="#user">User</a></li>
<li><a href="#upload">Upload</a></li>
<li><a href="#paint">Paint</a></li>
</ul>
</li>
<li><a href="#model">Model</a><ul>
<li><a href="#resultvo">ResultVO</a></li>
<li><a href="#uservo">UserVO</a></li>
<li><a href="#paintvo">PaintVO</a></li>
</ul>
</li>
<li><a href="#usage">Usage</a></li>
</ul>
</div>
</div>
</p>

<h1 id="说明">说明</h1>

<p>请求参数限制格式说明</p>

<pre class="prettyprint prettyprinted"><code><span class="pln">username</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">string</span><span class="pun">().</span><span class="pln">min</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="pln">max</span><span class="pun">(</span><span class="lit">10</span><span class="pun">).</span><span class="pln">without</span><span class="pun">(</span><span class="str">'access_token'</span><span class="pun">).</span><span class="pln">required</span><span class="pun">(),</span><span class="pln">
password</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">string</span><span class="pun">().</span><span class="pln">min</span><span class="pun">(</span><span class="lit">6</span><span class="pun">).</span><span class="pln">max</span><span class="pun">(</span><span class="lit">20</span><span class="pun">).</span><span class="pln">without</span><span class="pun">(</span><span class="str">'access_token'</span><span class="pun">).</span><span class="pln">required</span><span class="pun">(),</span><span class="pln">
email</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">string</span><span class="pun">().</span><span class="pln">email</span><span class="pun">().</span><span class="pln">without</span><span class="pun">(</span><span class="str">'access_token'</span><span class="pun">).</span><span class="pln">required</span><span class="pun">(),</span><span class="pln">
access_token</span><span class="pun">:</span><span class="kwd">string</span><span class="pun">().</span><span class="pln">without</span><span class="pun">(</span><span class="str">'username'</span><span class="pun">).</span><span class="pln">required</span><span class="pun">(),</span><span class="pln">
birthyear</span><span class="pun">:</span><span class="pln"> number</span><span class="pun">().</span><span class="pln">integer</span><span class="pun">().</span><span class="pln">min</span><span class="pun">(</span><span class="lit">1900</span><span class="pun">).</span><span class="pln">max</span><span class="pun">(</span><span class="lit">2014</span><span class="pun">)</span><span class="pln">
birthday</span><span class="pun">:</span><span class="pln"> date</span><span class="pun">().</span><span class="pln">min</span><span class="pun">(</span><span class="str">'1-1-1974'</span><span class="pun">).</span><span class="pln">max</span><span class="pun">(</span><span class="str">'1-1-2014'</span><span class="pun">)</span></code></pre>

<table>
<thead>
<tr>
  <th>关键词</th>
  <th>含义</th>
</tr>
</thead>
<tbody><tr>
  <td>string</td>
  <td>字符串</td>
</tr>
<tr>
  <td>min</td>
  <td>字符串是最短长度，数字为最小值，日期为最小天</td>
</tr>
<tr>
  <td>max</td>
  <td>字符串是最长长度，数字为最大值，日期为最大天</td>
</tr>
<tr>
  <td>without</td>
  <td>不能与什么参数同时存在</td>
</tr>
<tr>
  <td>with</td>
  <td>必须同什么参数一起出现</td>
</tr>
<tr>
  <td>required</td>
  <td>必须参数</td>
</tr>
<tr>
  <td>email</td>
  <td>必须符合邮件格式</td>
</tr>
<tr>
  <td>number</td>
  <td>数字</td>
</tr>
<tr>
  <td>integer</td>
  <td>整数</td>
</tr>
<tr>
  <td>date</td>
  <td>日期</td>
</tr>
</tbody></table>


<h1 id="api">API</h1>

<h2 id="user">User</h2>

<table>
<thead>
<tr>
  <th>URI</th>
  <th>Request</th>
  <th><a href="#resultvo">ResultVO</a></th>
</tr>
</thead>
<tbody><tr>
  <td>/user/signup/app<br><strong>POST</strong></td>
  <td><strong>username</strong>:string().min(1).max(10).without(‘access_token’).required(),<br><strong>password</strong>: string().min(6).max(20).without(‘access_token’).required(),<br><strong>email</strong>: string().email().without(‘access_token’).required(),<br><strong>come_from</strong>:string().required()</td>
  <td>results : <a href="#uservo">UserVO</a></td>
</tr>
<tr>
  <td>/user/login/platform<br><strong>POST</strong></td>
  <td><strong>come_from</strong>:string().required(),<br><strong>access_token</strong>:string().without(‘username’).required(),<br><strong>platform</strong>:string().without(‘username’).required(),<br><strong>usid</strong>:string().without(‘username’).required(),<br><strong>portrait</strong>:string(),<code>头像</code><br><strong>nickname</strong>:string().with(‘access_token’).required()<code>昵称</code></td>
  <td></td>
</tr>
<tr>
  <td>/user/login<br><strong>POST</strong></td>
  <td><strong>*username | email</strong><br><strong>*password</strong></td>
  <td>results : <a href="#uservo">UserVO</a></td>
</tr>
<tr>
  <td>/user/exist<br><strong>GET</strong></td>
  <td><strong>username | email | usid</strong></td>
  <td>results:true 用户存在<br>results:false 用户不存在</td>
</tr>
<tr>
  <td>/user/update<br><strong>POST</strong></td>
  <td><strong>portrait</strong>:string().max(50),<br><strong>mobile</strong>:number().min(13).max(13)<br><strong>address</strong>:string().min(5).max(200)<br><strong>birthday</strong>:date().min(‘1-1-1974’).max(‘1-1-2014’)</td>
  <td>status:true 更新成功<br>status:false 更新失败</td>
</tr>
</tbody></table>
<h2 id="upload">Upload</h2>

<table>
<thead>
<tr>
  <th>URI</th>
  <th>Request</th>
  <th><a href="#resultvo">ResultVO</a></th>
</tr>
</thead>
<tbody><tr>
  <td>/upload/token<br><strong>GET</strong></td>
  <td></td>
  <td>results:用户上传秘钥凭证</td>
</tr>
</tbody></table>


<h2 id="paint">Paint</h2>

<table>
<thead>
<tr>
  <th>URI</th>
  <th>Request</th>
  <th><a href="#resultvo">ResultVO</a></th>
</tr>
</thead>
<tbody><tr>
  <td>/paint/add<br><strong>POST</strong></td>
  <td><strong>cover</strong>:string().required()<br><strong>data</strong>:string().required<br><strong>audio</strong>:string()</td>
  <td>results:<a href="#paintvo">PaintVO</a></td>
</tr>
<tr>
  <td>/paint/get<br><strong>GET</strong></td>
  <td><strong>paint_id</strong>:string() 参照画的ID，为空则请求最新<br><strong>num</strong>:number() 请求数量，为<strong>正</strong>则表示请求比<strong>paint_id</strong>更新的，为<strong>负</strong>则表示请求更旧的<br><strong>author</strong>:string() 作者ID，为空则请求所有用户的<br><strong>favorited</strong>:boolean() 是否只显示已收藏的<br><strong>followed</strong>:boolean() 是否只显示我关注的</td>
  <td></td>
</tr>
</tbody></table>
<h1 id="model">Model</h1>

<h2 id="resultvo">ResultVO</h2>

<table>
<thead>
<tr>
  <th>property</th>
  <th>type</th>
  <th>description</th>
  <th>remark</th>
</tr>
</thead>
<tbody><tr>
  <td>status</td>
  <td>Boolean</td>
  <td>true:接口请求成功<br>false:接口请求失败</td>
  <td></td>
</tr>
<tr>
  <td>results</td>
  <td>Object</td>
  <td>任意数据对象，出错后返回错误原因</td>
  <td></td>
</tr>
<tr>
  <td>errorResult</td>
  <td>String</td>
  <td>出错时将结果对象转换为字符串</td>
  <td></td>
</tr>
</tbody></table>


<h2 id="uservo">UserVO</h2>

<table>
<thead>
<tr>
  <th>property</th>
  <th>type</th>
  <th>description</th>
  <th>remark</th>
</tr>
</thead>
<tbody><tr>
  <td>username</td>
  <td>String</td>
  <td>用户名</td>
  <td>唯一，可做登录</td>
</tr>
<tr>
  <td>password</td>
  <td>String</td>
  <td>密码</td>
  <td></td>
</tr>
<tr>
  <td>email</td>
  <td>String</td>
  <td>邮箱</td>
  <td>唯一，可做登录及找回密码</td>
</tr>
<tr>
  <td>portrait</td>
  <td>String</td>
  <td>头像</td>
  <td>157*157：个人中心<br>100*100：关注列表<br>50*50：画作详情作者<br></td>
</tr>
<tr>
  <td>nickname</td>
  <td>String</td>
  <td>昵称</td>
  <td>不唯一，画作作者</td>
</tr>
<tr>
  <td>come_from</td>
  <td>String</td>
  <td>用户来源</td>
  <td>画板默认DrawingBoard</td>
</tr>
</tbody></table>


<h2 id="paintvo">PaintVO</h2>

<table>
<thead>
<tr>
  <th>property</th>
  <th>type</th>
  <th>description</th>
  <th>remark</th>
</tr>
</thead>
<tbody><tr>
  <td>author</td>
  <td><a href="#uservo">UserVO</a></td>
  <td>画作者，可以获取到用户昵称和id</td>
  <td></td>
</tr>
<tr>
  <td>cover</td>
  <td>String</td>
  <td>封面地址</td>
  <td>634*477：显示于作品详情页<br>441*332：显示于画廊列表大图<br>300*226：显示于用户个人中心<br>213*160：显示于画廊列表小图<br>58*43：显示于消息列表</td>
</tr>
<tr>
  <td>data</td>
  <td>String</td>
  <td>绘图数据文件地址</td>
  <td></td>
</tr>
<tr>
  <td>audio</td>
  <td>String</td>
  <td>音频文件地址</td>
  <td></td>
</tr>
<tr>
  <td>views</td>
  <td>Number</td>
  <td>浏览数</td>
  <td></td>
</tr>
<tr>
  <td>plays</td>
  <td>Number</td>
  <td>播放数</td>
  <td></td>
</tr>
<tr>
  <td>comments</td>
  <td>Number</td>
  <td>评论数</td>
  <td></td>
</tr>
<tr>
  <td>favorites</td>
  <td>Number</td>
  <td>收藏数</td>
  <td></td>
</tr>
<tr>
  <td>agrees</td>
  <td>Number</td>
  <td>赞数</td>
  <td></td>
</tr>
<tr>
  <td>shares</td>
  <td>Number</td>
  <td>分享数</td>
  <td></td>
</tr>
</tbody></table>


<h1 id="usage">Usage</h1>

<pre class="prettyprint prettyprinted"><code><span class="typ">ServiceBase</span><span class="pun">.</span><span class="pln">HOST </span><span class="pun">=</span><span class="pln"> </span><span class="str">'http://db.pamakids.com'</span><span class="pun">;</span><span class="pln">

getSB</span><span class="pun">(</span><span class="str">'/user/signup'</span><span class="pun">).</span><span class="pln">call</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">result</span><span class="pun">:</span><span class="typ">ResultVO</span><span class="pun">):</span><span class="kwd">void</span><span class="pun">{</span><span class="pln">
                trace</span><span class="pun">(</span><span class="pln">result</span><span class="pun">.</span><span class="pln">status</span><span class="pun">,</span><span class="pln"> result</span><span class="pun">);</span><span class="pln">
            </span><span class="pun">},{</span><span class="pln">username</span><span class="pun">:</span><span class="str">'admin2'</span><span class="pun">,</span><span class="pln"> password</span><span class="pun">:</span><span class="str">'ads'</span><span class="pun">,</span><span class="pln"> come_from</span><span class="pun">:</span><span class="str">'DrawingBoard'</span><span class="pun">,</span><span class="pln"> email</span><span class="pun">:</span><span class="str">'test'</span><span class="pun">});</span><span class="pln">

</span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> getSB</span><span class="pun">(</span><span class="pln">uri</span><span class="pun">:</span><span class="typ">String</span><span class="pun">):</span><span class="typ">ServiceBase</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> sb</span><span class="pun">:</span><span class="typ">ServiceBase</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ServiceBase</span><span class="pun">(</span><span class="pln">uri</span><span class="pun">,</span><span class="pln"> </span><span class="str">'POST'</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> sb</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">           </span></code></pre></div></body>
</html>